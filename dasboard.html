<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .welcome {
            color: green;
        }
        .menu {
            margin: 20px 0;
        }
        .menu a {
            display: inline-block;
            margin-right: 15px;
            padding: 8px 15px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1 class="welcome">Selamat Datang, <span id="username"></span>!</h1>
    <p>Saldo Anda: <span id="balance">Rp 0</span></p>
    
    <div class="menu">
        <a href="profile.html">Profil</a>
        <a href="wallet.html">Dompet</a>
        <a href="#" onclick="logout()">Logout</a>
    </div>

    <!-- Load Supabase JS SDK -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        // Inisialisasi Supabase
        const supabaseUrl = 'https://waxqseyozmtelqplkjbl.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        // Cek session saat halaman dimuat
        async function checkSession() {
            const { data: { user }, error } = await supabase.auth.getUser();
            
            if (error || !user) {
                window.location.href = 'index.html';
            } else {
                // Tampilkan data user
                document.getElementById('username').textContent = 
                    user.user_metadata?.username || user.email;
                
                // Ambil data saldo (jika ada)
                getWalletBalance(user.id);
            }
        }

        // Ambil saldo dari database
        async function getWalletBalance(userId) {
            const { data, error } = await supabase
                .from('wallets')
                .select('balance')
                .eq('user_id', userId)
                .single();

            if (!error && data) {
                document.getElementById('balance').textContent = 
                    'Rp ' + data.balance.toLocaleString('id-ID');
            }
        }

        // Fungsi logout
        async function logout() {
            await supabase.auth.signOut();
            window.location.href = 'index.html';
        }

        // Jalankan saat halaman dimuat
        checkSession();
    </script>
</body>
</html>
